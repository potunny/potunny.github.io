<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/png" href="cookieicon.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fortune Cookie</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }
        /* DEFAULT (applies to small screens): solid purple, NO image at all */
            .bgimagediv {
                position: fixed;
                inset: 0;
                z-index: -1;
                background-color: rgb(49, 37, 48);   /* default for small screens */
        }
        /* Show image only on large screens */
        @media (min-width: 600px) {
        .bgimagediv {
            background-image: url('universebg.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            background-color: transparent;
        }
        }
        .centered {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .cookie-img {
            width: 200px;
            margin-bottom: 20px;
        }
        #showbutton {
            padding: 10px 20px;
            font-size: 18px;
            font-family: 'Comic Neue', 'Poppins', sans-serif;
            color: #ffffff;
            background: linear-gradient(135deg, #33022f, #cc42d1, #f1b43a);
            border: none;
            border-radius: 32px;
            cursor: pointer;
            transition: transform 0.15s ease, box-shadow 0.2s ease;
            font-weight: 600;
            letter-spacing: 0.8px;
            position: relative;
            overflow: hidden;
        }
        #showbutton:active {
            transform: scale(0.96);
            box-shadow: 0 4px 8px rgba(255, 144, 188, 0.3);
        }
        #fortune {
            margin-top: 20px;
            font-size: 22px;
            color: #ffe47a;
            font-family: 'Cinzel', 'Roboto', Arial, sans-serif;
            font-weight: 700;
            letter-spacing: 1.5px;
            text-shadow: 0 2px 8px #22222280, 0 0px 24px #e566ff80;
            background: linear-gradient(90deg, rgba(255, 243, 139, 0.26) 0%, rgba(43, 79, 146, 0.418) 100%);
            border-radius: 16px;
            padding: 18px 32px;
            box-shadow: 0 4px 24px rgba(66,133,244,0.12);
            transition: background 0.3s, color 0.3s;
            display: none; /*hidden until cookie is cracked*/
        }

        #fortune.active { /*when active, shows magical css above for phrase*/
            display: inline-block;
        }  
        .topbar {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            width: 100%;
            padding: 0px;
            box-sizing: border-box;
        }
        #buycredbutton {
            padding: 10px 20px;
            font-size: 18px;
            font-family: 'Comic Neue', 'Poppins', sans-serif;
            color: #fff;
            background: linear-gradient(135deg, #33022f, #cc42d1, #f1b43a);
            border: none;
            border-radius: 32px;
            box-shadow: 0 6px 12px rgba(255, 144, 188, 0.4),
                        0 0 12px rgba(255, 192, 217, 0.6);
            cursor: pointer;
            transition: transform 0.15s ease, box-shadow 0.2s ease;
            font-weight: 600;
            letter-spacing: 0.8px;
            position: relative;
            overflow: hidden;
        }
        
        #buycredbutton:disabled { /*disable button styling*/
            background: #e0e0e0;
            color: #aaa;
            cursor: auto;
            box-shadow: none;
}
        .buy-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #purchaseMsg {
            color: #ff3b47;
            font-weight: 300;
            font-family: 'Roboto', Arial, sans-serif;
            margin-top: 4px;
            min-height: 20px;
            text-align: center;
            position: static;
            padding: 2px;
        }
        #warnMsg {
            color: #ff3b47;
            font-weight: 300;
            font-family: 'Roboto', Arial, sans-serif;
            margin-top: 10px;
        }
        #cookieimage {
            width: 300px;
            margin-bottom: 20px;
            transition: transform 0.3s ease;
        }
        #cookieimage.cracked {
    /* Create a deep glow using a multi-layer box-shadow */
        box-shadow: 
            0 0 10px 5px #ff90bc, /* A soft pink inner glow */
            0 0 20px 10px #ffe066, /* A brighter yellow glow */
            0 0 30px 15px #cc42d1; /* A magical purple outer halo */
        
        /* Add a filter for a subtle color boost and extra blur */
        transform: scale(1.04); /* Slightly enlarge the image */
        transition: transform 0.3s ease, box-shadow 0.3s ease, filter 0.3s ease;
        margin-bottom: 60px;
        }

        #addmoneybutton {
            padding: 10px 20px;
            font-size: 18px;
            font-family: 'Comic Neue', 'Poppins', sans-serif;
            color: #ffffff;
            background: linear-gradient(135deg, #33022f, #cc42d1, #f1b43a);
            border: none;
            border-radius: 32px;
            cursor: pointer;
            transition: transform 0.15s ease, box-shadow 0.2s ease;
            font-weight: 600;
            letter-spacing: 0.8px;
            position: relative;
            overflow: hidden;
        }
        #creditcount, #cookiesBought {
            font-family: 'Roboto', Arial, sans-serif;
            color: #ffffff;
            margin: 8px 0 0 0;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <div class="bgimagediv" aria-hidden="true"></div>
    <div class="topbar">
        <div class="buy-wrapper">
            <button id="buycredbutton" onclick="buyCookie()" disabled>Buy One Cookie</button>
            <button id="addmoneybutton" onclick="addMoney()">Add One Money</button>
            <p id="creditcount">Money: 0</p>
            <p id="cookiesBought">Cookies: 0</p>
            <span id="purchaseMsg"></span>
        </div>
    </div>
    <div class="centered">
        <img id = "cookieimage" src="realcookie.png" alt="Fortune Cookie"">
        <button id="showbutton" onclick="showFortune()">Crack Cookie</button>
        <p id="fortune"></p>
        <span id="warnMsg"></span>
    </div>
    <script>
// Buying
    let money = 0; //initial money
    document.getElementById("creditcount").innerText = `Money: ${money}`
    let cookiesBought = 0; //to know when to show you have no money message

function buyCookie() {
    if (money < 1) {
        document.getElementById("warnMsg").innerText = "You don't have enough money!";
        return;
    }
    cookiesBought++; // add one cookie
    money--; // subtract one money
    document.getElementById("creditcount").innerText = `Money: ${money}`;
    document.getElementById("cookiesBought").innerText = `Cookies: ${cookiesBought}`;
    document.getElementById("purchaseMsg").innerText = "Cookie purchased!";
    document.getElementById("warnMsg").innerText = "";

    // If money is now zero, disable buy button
    if (money === 0) {
        document.getElementById("buycredbutton").disabled = true;
    }
}

function addMoney() { //adds money when button clicked
    money++;
    document.getElementById("creditcount").innerText = `Money: ${money}`;
    if (money > 0) {
        document.getElementById("buycredbutton").disabled = false; //reenables buy button
        document.getElementById("warnMsg").innerText = "";
    }
    else {
        if (money <= 0) {
            document.getElementById("warnMsg").innerText = "You don't have enough money!";
            return;
        }
    }
}

function showFortune() { //and changes cookie picture
    if (cookiesBought > 0){
        const fortune = generateFortune();
        const fortuneEl = document.getElementById("fortune");
        fortuneEl.innerText = fortune;
        fortuneEl.style.display = "inline-block"; // reveal with styling
        document.getElementById("purchaseMsg").innerText = "";

        document.getElementById("warnMsg").innerText = "";

        // Change cookie image to cracked version
        const cookieImage = document.getElementById("cookieimage");
        cookieImage.src = "openedcookie.jpg";
        cookieImage.classList.add("cracked"); 
    } else {
        if (cookiesBought <= 0) {
            document.getElementById("warnMsg").innerText = "You don't have any cookies! Buy one first.";
            return;
        }
    }
    cookiesBought--; //subtract one cookie
    document.getElementById("cookiesBought").innerText = `Cookies: ${cookiesBought}`;
}
// Fortune Generation
    const templates = [
  "A {adj_animal} {animal} will {action_object}.",
  "Beware: the {animal_place} of {place} seeks your {object_prophecy}.",
  "Tonight, a {adj_shadow} shadow will {action_creature}.",
  "A {animal} whispers: {prophecy}.",
  "In {place}, your {object_place} shall be {action_passive} by a {adj_animal}.",
  "The {adj_animal} {animal} hides a secret about your {object_secret}."
];

// Context-specific word arrays
const adj_animal = ["mysterious", "spooky", "forgotten", "ancient", "gentle", "restless"];
const adj_shadow = ["spooky", "chaotic", "restless", "eternal"];
const animal_place = ["crow", "serpent", "wolf", "ghost", "dragon"];

const animals = ["bat", "crow", "cat", "serpent", "owl", "wolf", "dragon", "ghost"];
const places = ["the forest", "the old castle", "the graveyard", "the hidden cave", "the midnight sky"];
const prophecies = [
  `"The veil is thin tonight"`,
  `"What you seek also seeks you"`,
  `"An old friend returns in silence"`,
  `"Your dreams will guide you"`,
  `"Magic is closer than you think"`,
  `"Your reflection hides a truth"`,
  `"Beware of glitter in the dark"`,
  `"An old friend returns in silence"`
];

// Arrays combining logically related words
const action_object = [
  { action: "bless", object: "your dreams" },
  { action: "steal", object: "your secrets" },
  { action: "haunt", object: "your nightmares" },
  { action: "guard", object: "your path" },
  { action: "reveal", object: "a forgotten memory" },
  { action: "watch over", object: "your journey" }
];
const action_creature = [
  { action: "whisper to", object: "the wind" },
  { action: "follow", object: "your footsteps" },
  { action: "embrace", object: "the silence" },
  { action: "curse", object: "the old tree" }
];
const object_prophecy = ["heart", "future", "shadow", "destiny"];
const object_secret = ["dreams", "past", "family", "reflection"];
const object_place = ["treasure", "heart", "future", "legacy"];
const action_passive = ["blessed", "guarded", "haunted", "found"];


function getRandomElement(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
}

function generateFortune() {
    let template = getRandomElement(templates);

    // Get random elements from context-specific arrays
    const chosen_adj_animal = getRandomElement(adj_animal);
    const chosen_animal_place = getRandomElement(animal_place);
    const chosen_adj_shadow = getRandomElement(adj_shadow);
    const chosen_animal = getRandomElement(animals);
    const chosen_place = getRandomElement(places);
    const chosen_prophecy = getRandomElement(prophecies);

    // Get a random action-object pair and split it
    const actionObjectPair = getRandomElement(action_object);
    const actionCreaturePair = getRandomElement(action_creature);
    const objectPassivePair = getRandomElement(object_place);
    const actionPassivePair = getRandomElement(action_passive);

    // Replace the placeholders with the selected words
    return template
        .replace("{adj_animal}", chosen_adj_animal)
        .replace("{animal_place}", chosen_animal_place)
        .replace("{adj_shadow}", chosen_adj_shadow)
        .replace("{animal}", chosen_animal)
        .replace("{place}", chosen_place)
        .replace("{prophecy}", chosen_prophecy)
        .replace("{action_object}", `${actionObjectPair.action} ${actionObjectPair.object}`)
        .replace("{action_creature}", `${actionCreaturePair.action} ${actionCreaturePair.object}`)
        .replace("{object_prophecy}", getRandomElement(object_prophecy))
        .replace("{object_secret}", getRandomElement(object_secret))
        .replace("{object_place}", objectPassivePair)
        .replace("{action_passive}", actionPassivePair);
}
    </script>
</body>
</html>